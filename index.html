<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#111827" />
    <title>Weight Tracker</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div>
        <h1>Weight Tracker</h1>
        <p class="sub">Trailing averages (calendar-windowed) with prior-period comparison.</p> 
        <p class="sub">Version: <span id="appVersion">—</span></p>
      </div>
      <div class="pill" id="installHint" hidden>Tip: Add to Home Screen</div>
    </header>

    <main class="container">
      <section class="card">
        <h2>Quick Add</h2>
        <div class="row">
          <label>
            Date
            <input id="dateInput" type="date" />
          </label>
          <label>
            Weight
            <input id="weightInput" type="number" inputmode="decimal" step="0.1" placeholder="e.g. 179.6" />
          </label>
          <label>
            Notes (optional)
            <input id="notesInput" type="text" placeholder="e.g. salty dinner" />
          </label>
        </div>
        <div class="actions">
          <button id="addBtn" class="primary">Add entry</button>
          <button id="cancelBtn" class="ghost" style="display:none;">Cancel</button>
          <button id="clearBtn" class="ghost" title="Clears all local data">Clear all</button>
        </div>
        <p class="tiny muted">
          Data is stored locally on this device (offline). Averages are based on calendar days; missed days are skipped (no zero-fill).
        </p>
      </section>

      <section class="grid">
        <div class="card metric">
          <div class="label">Latest date</div>
          <div class="value" id="latestDate">—</div>
        </div>

        <div class="card metric">
          <div class="label">Latest weight</div>
          <div class="value" id="latestWeight">—</div>
        </div>

          <div class="card metric">
          <div class="label">As-of date</div>
          <div class="value" id="asOfDateDisplay">—</div>

          <div class="row" style="margin-top:10px; gap:8px; align-items:end;">
            <button id="asOfPrev" class="ghost" type="button" title="Previous entry date">◀</button>

            <label style="flex:1;">
              Jump
              <select id="asOfSelect"></select>
            </label>

            <button id="asOfNext" class="ghost" type="button" title="Next entry date">▶</button>
          </div>

          <div class="tiny muted" style="margin-top:8px;">
            Time travel: stats compute as if viewed on the selected day.
          </div>
        </div>

        <div class="card metric">
          <div class="label">MA7</div>
          <div class="value" id="ma7">—</div>
          <div class="tiny muted">Current (last 7 calendar days)</div>
          <div class="tiny muted">Prior: <span id="ma7Prev">—</span></div>
          <div class="tiny muted">Δ: <span id="ma7Delta">—</span></div>
          <div class="row" style="margin-top:10px; gap:10px; align-items:end;">
            <label style="flex:1;">
              Goal Δ7
              <input id="goalDelta7" type="number" step="0.1" inputmode="decimal" value="0.0" />
            </label>
            <div style="min-width:140px;">
              <div class="tiny muted">Req next-7 avg</div>
              <div class="value" id="reqNext7Avg">—</div>
            </div>
          </div>
          <div class="tiny muted" id="reqNext7Hint" style="margin-top:6px;">—</div>

        </div>

        <div class="card metric">
          <div class="label">MA14</div>
          <div class="value" id="ma14">—</div>
          <div class="tiny muted">Current (last 14 calendar days)</div>
          <div class="tiny muted">Prior: <span id="ma14Prev">—</span></div>
          <div class="tiny muted">Δ: <span id="ma14Delta">—</span></div>
        </div>

        <div class="card metric">
          <div class="label">MA28</div>
          <div class="value" id="ma28">—</div>
          <div class="tiny muted">Current (last 28 calendar days)</div>
          <div class="tiny muted">Prior: <span id="ma28Prev">—</span></div>
          <div class="tiny muted">Δ: <span id="ma28Delta">—</span></div>
        </div>

        </section>

      <section class="card">
        <h2>Entries</h2>
        <div class="tiny muted" id="entryStats">—</div>
        <div class="list" id="entriesList"></div>
      </section>

      <section class="card">
        <h2>How the math works</h2>
        <ul class="tiny">
          <li>
            <b>MA7 / MA14 / MA28</b>: averages of entries dated within the last 7 / 14 / 28
            calendar days relative to your latest logged date.
          </li>
          <li>
            <b>Prior</b>: the immediately preceding calendar window of the same length.
          </li>
          <li>
            <b>Δ</b>: current average minus prior average (positive means upward trend).
          </li>
          <li>
            If you skip a day, it is simply not counted (no zeros inserted).
          </li>
        </ul>
      </section>
    </main>

    <script src="app.js?v=20260202.7"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () =>
          navigator.serviceWorker.register("./sw.js")
        );
      }
    </script>
  </body>
</html>












